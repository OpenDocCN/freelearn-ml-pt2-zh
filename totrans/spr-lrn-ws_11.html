<html><head></head><body>
		<br/>
		<p class="style0">3. Linear Regression</p>
		<div style="page-break-before: always;"/>
	

		<br/>
		<h4 class="style0">Activity 3.01: Plotting Data with a Moving Average</h4>
		<br/>
		<p class="style0">Load the two required packages:</p>
		<br/>
		<p class="style0">import pandas as pd</p>
		<br/>
		<p class="style0">import matplotlib.pyplot as plt</p>
		<br/>
		<p class="style0">Load the dataset into a pandas DataFrame from the CSV file:</p>
		<br/>
		<p class="style0">df = pd.read_csv('../Datasets/austin_weather.csv')</p>
		<br/>
		<p class="style0">df.head()</p>
		<br/>
		<p class="style0">The output will show the initial five rows of the austin_weather.csv file:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-2E71SJK6.jpg" alt="Figure 3.61: The first five rows of the Austin weather data (note that additional columns to the right are not shown)&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.61: The first five rows of the Austin weather data (note that additional columns to the right are not shown)</p>
		<br/>
		<p class="style0">Since we only need the Date and TempAvgF columns, we'll remove all the other columns from the dataset:</p>
		<br/>
		<p class="style0">df = df.loc[:, ['Date', 'TempAvgF']]</p>
		<br/>
		<p class="style0">df.head()</p>
		<br/>
		<p class="style0">The output will be as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-TIPMXHMW.jpg" alt="Figure 3.62: Date and TempAvgF columns of the Austin weather data&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.62: Date and TempAvgF columns of the Austin weather data</p>
		<br/>
		<p class="style0">Initially, we are only interested in the first year's data, so we need to extract that information only. Create a column in the DataFrame for the year value, extract the year value as an integer from the strings in the Date column, and assign these values to the Year column (note that temperatures are recorded daily). Repeat the process to create the Month and Day columns, and then extract the first year's worth of data:</p>
		<br/>
		<p class="style0">df.loc[:, 'Year'] = df.loc[:, 'Date'].str.slice(0, 4).astype('int')</p>
		<br/>
		<p class="style0">df.loc[:, 'Month'] = df.loc[:, 'Date'].str.slice(5, 7).astype('int')</p>
		<br/>
		<p class="style0">df.loc[:, 'Day'] = df.loc[:, 'Date'].str.slice(8, 10).astype('int')</p>
		<br/>
		<p class="style0">df = df.loc[df.index &lt; 365]</p>
		<br/>
		<p class="style0">print(df.head())</p>
		<br/>
		<p class="style0">print(df.tail())</p>
		<br/>
		<p class="style0">The output will be as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-NKHKLFEF.jpg" alt="Figure 3.63: New DataFrame with one year's worth of data&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.63: New DataFrame with one year's worth of data</p>
		<br/>
		<p class="style0">Compute a 20-day moving average using the rolling() method:</p>
		<br/>
		<p class="style0">window = 20</p>
		<br/>
		<p class="style0">rolling = df.TempAvgF.rolling(window).mean()</p>
		<br/>
		<p class="style0">print(rolling.head())</p>
		<br/>
		<p class="style0">print(rolling.tail())</p>
		<br/>
		<p class="style0">The output will be as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-EXGYSL7Q.jpg" alt="Figure 3.64: DataFrame with moving average data&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.64: DataFrame with moving average data</p>
		<br/>
		<p class="style0">Plot the raw data and the moving averages, with the x axis as the day number in the year:</p>
		<br/>
		<p class="style0">fig = plt.figure(figsize=(10, 7))</p>
		<br/>
		<p class="style0">ax = fig.add_axes([1, 1, 1, 1]);</p>
		<br/>
		<p class="style0"># Raw data</p>
		<br/>
		<p class="style0">ax.scatter(df.index, df.TempAvgF, \</p>
		<br/>
		<p class="style0">           label = 'Raw Data', c = 'k')</p>
		<br/>
		<p class="style0"># Moving averages</p>
		<br/>
		<p class="style0">ax.plot(rolling.index, rolling, c = 'r', \</p>
		<br/>
		<p class="style0">        linestyle = '--', label = f'{window} day moving average')</p>
		<br/>
		<p class="style0">ax.set_title('Air Temperature Measurements', fontsize = 16)</p>
		<br/>
		<p class="style0">ax.set_xlabel('Day', fontsize = 14)</p>
		<br/>
		<p class="style0">ax.set_ylabel('Temperature ($^\circ$F)', fontsize = 14)</p>
		<br/>
		<p class="style0">ax.set_xticks(range(df.index.min(), df.index.max(), 30))</p>
		<br/>
		<p class="style0">ax.tick_params(labelsize = 12)</p>
		<br/>
		<p class="style0">ax.legend(fontsize = 12)</p>
		<br/>
		<p class="style0">plt.show()</p>
		<br/>
		<p class="style0">The output will be as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-8UW6PKOO.jpg" alt="Figure 3.65: Temperature data with the 20-day moving average overlaid&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.65: Temperature data with the 20-day moving average overlaid</p>
		<br/>
		<h4 class="style2">Note</h4>
		<br/>
		<p class="style2">To access the source code for this specific section, please refer to https://packt.live/2Nl5m85.</p>
		<br/>
		<p class="style2">You can also run this example online at https://packt.live/3epJvs6. You must execute the entire Notebook in order to get the desired result.</p>
		<div style="page-break-before: always;"/>
	

		<br/>
		<h4 class="style0">Activity 3.02: Linear Regression Using the Least Squares Method</h4>
		<br/>
		<p class="style0">Import the required packages and classes:</p>
		<br/>
		<p class="style0">import pandas as pd</p>
		<br/>
		<p class="style0">import matplotlib.pyplot as plt</p>
		<br/>
		<p class="style0">from sklearn.linear_model import LinearRegression</p>
		<br/>
		<p class="style0">Load the data from the CSV (austin_weather.csv) and inspect the data (using the head() and tail() methods):</p>
		<br/>
		<p class="style0"># load data and inspect</p>
		<br/>
		<p class="style0">df = pd.read_csv('../Datasets/austin_weather.csv')</p>
		<br/>
		<p class="style0">print(df.head())</p>
		<br/>
		<p class="style0">print(df.tail())</p>
		<br/>
		<p class="style0">The output for df.head() will be as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-BFFQ5FTD.jpg" alt="Figure 3.66: Output for df.head()&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.66: Output for df.head()</p>
		<br/>
		<p class="style0">The output for df.tail() will be as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-8HWYSH8L.jpg" alt="Figure 3.67: Output for df.tail()&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.67: Output for df.tail()</p>
		<br/>
		<p class="style0">Drop everything except the Date and TempAvgF columns:</p>
		<br/>
		<p class="style0">df = df.loc[:, ['Date', 'TempAvgF']]</p>
		<br/>
		<p class="style0">df.head()</p>
		<br/>
		<p class="style0">The output will be as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-TBONUR9Z.jpg" alt="Figure 3.68: Two columns used for Activity 3.02&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.68: Two columns used for Activity 3.02</p>
		<br/>
		<p class="style0">Create new Year, Month, and Day columns and populate them by parsing the Date column:</p>
		<br/>
		<p class="style0"># add some useful columns</p>
		<br/>
		<p class="style0">df.loc[:, 'Year'] = df.loc[:, 'Date']\</p>
		<br/>
		<p class="style0">                    .str.slice(0, 4).astype('int')</p>
		<br/>
		<p class="style0">df.loc[:, 'Month'] = df.loc[:, 'Date']\</p>
		<br/>
		<p class="style0">                     .str.slice(5, 7).astype('int')</p>
		<br/>
		<p class="style0">df.loc[:, 'Day'] = df.loc[:, 'Date']\</p>
		<br/>
		<p class="style0">                   .str.slice(8, 10).astype('int')</p>
		<br/>
		<p class="style0">print(df.head())</p>
		<br/>
		<p class="style0">print(df.tail())</p>
		<br/>
		<p class="style0">The output will be as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-HRXD8ELZ.jpg" alt="Figure 3.69: Augmented data&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.69: Augmented data</p>
		<br/>
		<p class="style0">Create a new column for a moving average and populate it with a 20-day moving average of the TempAvgF column:</p>
		<br/>
		<p class="style0">"""</p>
		<br/>
		<p class="style0">set a 20 day window then use that to smooth temperature in a new column</p>
		<br/>
		<p class="style0">"""</p>
		<br/>
		<p class="style0">window = 20</p>
		<br/>
		<p class="style0">df['20_d_mov_avg'] = df.TempAvgF.rolling(window).mean()</p>
		<br/>
		<p class="style0">print(df.head())</p>
		<br/>
		<p class="style0">print(df.tail())</p>
		<br/>
		<p class="style0">The output will be as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-W20OBT4B.jpg" alt="Figure 3.70: Addition of the 20-day moving average&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.70: Addition of the 20-day moving average</p>
		<br/>
		<p class="style0">Slice one complete year of data to use in a model. Ensure the year doesn't have missing data due to the moving average. Also create a column for Day_of_Year (it should start at 1):</p>
		<br/>
		<p class="style0">"""</p>
		<br/>
		<p class="style0">now let's slice exactly one year on the</p>
		<br/>
		<p class="style0">calendar start and end dates</p>
		<br/>
		<p class="style0">we see from the previous output that</p>
		<br/>
		<p class="style0">2014 is the first year with complete data,</p>
		<br/>
		<p class="style0">however it will still have NaN values for</p>
		<br/>
		<p class="style0">the moving average, so we'll use 2015</p>
		<br/>
		<p class="style0">"""</p>
		<br/>
		<p class="style0">df_one_year = df.loc[df.Year == 2015, :].reset_index()</p>
		<br/>
		<p class="style0">df_one_year['Day_of_Year'] = df_one_year.index + 1</p>
		<br/>
		<p class="style0">print(df_one_year.head())</p>
		<br/>
		<p class="style0">print(df_one_year.tail())</p>
		<br/>
		<p class="style0">The output will be as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-3PS8EM65.jpg" alt="Figure 3.71: One year's worth of data&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.71: One year's worth of data</p>
		<br/>
		<p class="style0">Create a scatterplot of the raw data (the original TempAvgF column) and overlay it with a line for the 20-day moving average:</p>
		<br/>
		<p class="style0">fig = plt.figure(figsize=(10, 7))</p>
		<br/>
		<p class="style0">ax = fig.add_axes([1, 1, 1, 1]);</p>
		<br/>
		<p class="style0"># Raw data</p>
		<br/>
		<p class="style0">ax.scatter(df_one_year.Day_of_Year, df_one_year.TempAvgF, \</p>
		<br/>
		<p class="style0">           label = 'Raw Data', c = 'k')</p>
		<br/>
		<p class="style0"># Moving averages</p>
		<br/>
		<p class="style0">ax.plot(df_one_year.Day_of_Year, df_one_year['20_d_mov_avg'], \</p>
		<br/>
		<p class="style0">        c = 'r', linestyle = '--', \</p>
		<br/>
		<p class="style0">        label = f'{window} day moving average')</p>
		<br/>
		<p class="style0">ax.set_title('Air Temperature Measurements', fontsize = 16)</p>
		<br/>
		<p class="style0">ax.set_xlabel('Day', fontsize = 14)</p>
		<br/>
		<p class="style0">ax.set_ylabel('Temperature ($^\circ$F)', fontsize = 14)</p>
		<br/>
		<p class="style0">ax.set_xticks(range(df_one_year.Day_of_Year.min(), \</p>
		<br/>
		<p class="style0">                    df_one_year.Day_of_Year.max(), 30))</p>
		<br/>
		<p class="style0">ax.tick_params(labelsize = 12)</p>
		<br/>
		<p class="style0">ax.legend(fontsize = 12)</p>
		<br/>
		<p class="style0">plt.show()</p>
		<br/>
		<p class="style0">The output will be as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-7IRREJQI.jpg" alt="Figure 3.72: Raw data with the 20-day moving average overlaid&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.72: Raw data with the 20-day moving average overlaid</p>
		<br/>
		<p class="style0">Create a linear regression model using the default parameters, that is, calculate a y intercept for the model and do not normalize the data. The day numbers for the year (1 to 365) constitute the input data and the average temperatures constitute the output data. Print the parameters of the model and the r2 value:</p>
		<br/>
		<p class="style0"># fit a linear model</p>
		<br/>
		<p class="style0">linear_model = LinearRegression(fit_intercept = True)</p>
		<br/>
		<p class="style0">linear_model.fit(df_one_year['Day_of_Year']\</p>
		<br/>
		<p class="style0">                 .values.reshape((-1, 1)), \</p>
		<br/>
		<p class="style0">                 df_one_year.TempAvgF)</p>
		<br/>
		<p class="style0">print('model slope: ', linear_model.coef_)</p>
		<br/>
		<p class="style0">print('model intercept: ', linear_model.intercept_)</p>
		<br/>
		<p class="style0">print('model r squared: ', \</p>
		<br/>
		<p class="style0">      linear_model.score(df_one_year['Day_of_Year']\</p>
		<br/>
		<p class="style0">                         .values.reshape((-1, 1)), \</p>
		<br/>
		<p class="style0">                         df_one_year.TempAvgF))</p>
		<br/>
		<p class="style0">The results should be as follows:</p>
		<br/>
		<p class="style0">model slope: [0.04304568]</p>
		<br/>
		<p class="style0">model intercept: 62.23496914044859</p>
		<br/>
		<p class="style0">model r squared: 0.09549593659736466</p>
		<br/>
		<p class="style0">Note that the r2 value is very low, which is not surprising given that the data has a significant variation in the slope over time, and we are fitting a single linear model with a constant slope.</p>
		<br/>
		<p class="style0">Generate predictions from the model using the same x data:</p>
		<br/>
		<p class="style0"># make predictions using the training data</p>
		<br/>
		<p class="style0">y_pred = linear_model.predict(df_one_year['Day_of_Year']\</p>
		<br/>
		<p class="style0">                              .values.reshape((-1, 1)))</p>
		<br/>
		<p class="style0">x_pred = df_one_year.Day_of_Year</p>
		<br/>
		<p class="style0">Create a new scatterplot, as before, adding an overlay of the predictions of the model:</p>
		<br/>
		<p class="style0">fig = plt.figure(figsize=(10, 7))</p>
		<br/>
		<p class="style0">ax = fig.add_axes([1, 1, 1, 1]);</p>
		<br/>
		<p class="style0"># Raw data</p>
		<br/>
		<p class="style0">ax.scatter(df_one_year.Day_of_Year, df_one_year.TempAvgF, \</p>
		<br/>
		<p class="style0">           label = 'Raw Data', c = 'k')</p>
		<br/>
		<p class="style0"># Moving averages</p>
		<br/>
		<p class="style0">ax.plot(df_one_year.Day_of_Year, df_one_year['20_d_mov_avg'], \</p>
		<br/>
		<p class="style0">        c = 'r', linestyle = '--', \</p>
		<br/>
		<p class="style0">        label = f'{window} day moving average')</p>
		<br/>
		<p class="style0"># linear model</p>
		<br/>
		<p class="style0">ax.plot(x_pred, y_pred, c = "blue", linestyle = '-.', \</p>
		<br/>
		<p class="style0">        label = 'linear model')</p>
		<br/>
		<p class="style0">ax.set_title('Air Temperature Measurements', fontsize = 16)</p>
		<br/>
		<p class="style0">ax.set_xlabel('Day', fontsize = 14)</p>
		<br/>
		<p class="style0">ax.set_ylabel('Temperature ($^\circ$F)', fontsize = 14)</p>
		<br/>
		<p class="style0">ax.set_xticks(range(df_one_year.Day_of_Year.min(), \</p>
		<br/>
		<p class="style0">                    df_one_year.Day_of_Year.max(), 30))</p>
		<br/>
		<p class="style0">ax.tick_params(labelsize = 12)</p>
		<br/>
		<p class="style0">ax.legend(fontsize = 12)</p>
		<br/>
		<p class="style0">plt.show()</p>
		<br/>
		<p class="style0">The output will be as follows:</p>
		<br/>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-S2PMM96W.jpg" alt="Figure 3.73: Raw data, 20-day moving average, and linear fit&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.73: Raw data, 20-day moving average, and linear fit</p>
		<br/>
		<h4 class="style2">Note</h4>
		<br/>
		<p class="style2">To access the source code for this specific section, please refer to https://packt.live/2CwEKyT.</p>
		<br/>
		<p class="style2">You can also run this example online at https://packt.live/3hKJSzD. You must execute the entire Notebook in order to get the desired result.</p>
		<div style="page-break-before: always;"/>
	

		<br/>
		<h4 class="style0">Activity 3.03: Dummy Variables</h4>
		<br/>
		<p class="style0">Import the required packages and classes:</p>
		<br/>
		<p class="style0">import pandas as pd</p>
		<br/>
		<p class="style0">import matplotlib.pyplot as plt</p>
		<br/>
		<p class="style0">from sklearn.linear_model import LinearRegression</p>
		<br/>
		<p class="style0">Load and inspect the data:</p>
		<br/>
		<p class="style0"># load data and inspect</p>
		<br/>
		<p class="style0">df = pd.read_csv('../Datasets/austin_weather.csv')</p>
		<br/>
		<p class="style0">print(df.head())</p>
		<br/>
		<p class="style0">print(df.tail())</p>
		<br/>
		<p class="style0">The output for df.head() should appear as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-XIIHGZ3P.jpg" alt="Figure 3.74: Output for the df.head() function&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.74: Output for the df.head() function</p>
		<br/>
		<p class="style0">The output for df.tail() should appear as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-2UIYD0ID.jpg" alt="Figure 3.75: Output for the df.tail() function&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.75: Output for the df.tail() function</p>
		<br/>
		<p class="style0">Carry out the preprocessing as before. Drop all but the Date and TempAvgF columns. Add columns for Year, Month, and Day. Create a new column with a 20-day moving average. Slice out the first complete year (2015):</p>
		<br/>
		<p class="style0">df = df.loc[:, ['Date', 'TempAvgF']]</p>
		<br/>
		<p class="style0"># add some useful columns</p>
		<br/>
		<p class="style0">df.loc[:, 'Year'] = df.loc[:, 'Date'].str.slice(0, 4).astype('int')</p>
		<br/>
		<p class="style0">df.loc[:, 'Month'] = df.loc[:, 'Date'].str.slice(5, 7).astype('int')</p>
		<br/>
		<p class="style0">df.loc[:, 'Day'] = df.loc[:, 'Date'].str.slice(8, 10).astype('int')</p>
		<br/>
		<p class="style0">"""</p>
		<br/>
		<p class="style0">set a 20 day window then use that to smooth</p>
		<br/>
		<p class="style0">temperature in a new column</p>
		<br/>
		<p class="style0">"""</p>
		<br/>
		<p class="style0">window = 20</p>
		<br/>
		<p class="style0">df['20_d_mov_avg'] = df.TempAvgF.rolling(window).mean()</p>
		<br/>
		<p class="style0">"""</p>
		<br/>
		<p class="style0">now let's slice exactly one year on the</p>
		<br/>
		<p class="style0">calendar start and end dates</p>
		<br/>
		<p class="style0">we see from the previous output that</p>
		<br/>
		<p class="style0">2014 is the first year with complete data,</p>
		<br/>
		<p class="style0">however it will still have NaN values for</p>
		<br/>
		<p class="style0">the moving average, so we'll use 2015</p>
		<br/>
		<p class="style0">"""</p>
		<br/>
		<p class="style0">df_one_year = df.loc[df.Year == 2015, :].reset_index()</p>
		<br/>
		<p class="style0">df_one_year['Day_of_Year'] = df_one_year.index + 1</p>
		<br/>
		<p class="style0">print(df_one_year.head())</p>
		<br/>
		<p class="style0">print(df_one_year.tail())</p>
		<br/>
		<p class="style0">The data should appear as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-XGAKT751.jpg" alt="Figure 3.76: Preprocessed data&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.76: Preprocessed data</p>
		<br/>
		<p class="style0">Visualize the results:</p>
		<br/>
		<p class="style0">fig = plt.figure(figsize=(10, 7))</p>
		<br/>
		<p class="style0">ax = fig.add_axes([1, 1, 1, 1]);</p>
		<br/>
		<p class="style0"># Raw data</p>
		<br/>
		<p class="style0">ax.scatter(df_one_year.Day_of_Year, df_one_year.TempAvgF, \</p>
		<br/>
		<p class="style0">           label = 'Raw Data', c = 'k')</p>
		<br/>
		<p class="style0"># Moving averages</p>
		<br/>
		<p class="style0">ax.plot(df_one_year.Day_of_Year, df_one_year['20_d_mov_avg'], \</p>
		<br/>
		<p class="style0">        c = 'r', linestyle = '--', \</p>
		<br/>
		<p class="style0">        label = f'{window} day moving average')</p>
		<br/>
		<p class="style0">ax.set_title('Air Temperature Measurements', fontsize = 16)</p>
		<br/>
		<p class="style0">ax.set_xlabel('Day', fontsize = 14)</p>
		<br/>
		<p class="style0">ax.set_ylabel('Temperature ($^\circ$F)', fontsize = 14)</p>
		<br/>
		<p class="style0">ax.set_xticks(range(df_one_year.Day_of_Year.min(), \</p>
		<br/>
		<p class="style0">                    df_one_year.Day_of_Year.max(), 30))</p>
		<br/>
		<p class="style0">ax.tick_params(labelsize = 12)</p>
		<br/>
		<p class="style0">ax.legend(fontsize = 12)</p>
		<br/>
		<p class="style0">plt.show()</p>
		<br/>
		<p class="style0">The plot should appear as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-3G0548EA.jpg" alt="Figure 3.77: Austin temperatures and moving average&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.77: Austin temperatures and moving average</p>
		<br/>
		<p class="style0">We can see that the temperature rises from January to around September, and then falls again. This is a clear seasonal cycle. As a first improvement, we can include the month in the model. As described in the introduction to dummy variables, if we just encoded the months as integers 1 to 12, the model might interpret that December (12) was more important than January (1). So, we encode the month as dummy variables to avoid this:</p>
		<br/>
		<p class="style0"># use the month as a dummy variable</p>
		<br/>
		<p class="style0">dummy_vars = pd.get_dummies(df_one_year['Month'], drop_first = True)</p>
		<br/>
		<p class="style0">dummy_vars.columns = ['Feb', 'Mar', 'Apr', 'May', 'Jun', \</p>
		<br/>
		<p class="style0">                      'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']</p>
		<br/>
		<p class="style0">df_one_year = pd.concat([df_one_year, dummy_vars], \</p>
		<br/>
		<p class="style0">                        axis = 1).drop('Month', axis = 1)</p>
		<br/>
		<p class="style0">df_one_year</p>
		<br/>
		<p class="style0">The data should appear as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-XN7VJ280.jpg" alt="Figure 3.78: Data augmented with dummy variables for the month&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.78: Data augmented with dummy variables for the month</p>
		<br/>
		<p class="style0">Now, fit a linear model using Day_of_Year and the dummy variables, and print the model coefficients and the r2 value:</p>
		<br/>
		<p class="style0"># fit model using the month dummy vars</p>
		<br/>
		<p class="style0">linear_model = LinearRegression(fit_intercept = True)</p>
		<br/>
		<p class="style0">linear_model.fit(pd.concat([df_one_year.Day_of_Year, \</p>
		<br/>
		<p class="style0">                            df_one_year.loc[:, 'Feb':'Dec']], \</p>
		<br/>
		<p class="style0">                                            axis = 1),</p>
		<br/>
		<p class="style0">                            df_one_year['TempAvgF'])</p>
		<br/>
		<p class="style0">print('model coefficients: ', linear_model.coef_)</p>
		<br/>
		<p class="style0">print('model intercept: ', linear_model.intercept_)</p>
		<br/>
		<p class="style0">print('model r squared: ', \</p>
		<br/>
		<p class="style0">      linear_model.score(pd.concat([df_one_year.Day_of_Year, \</p>
		<br/>
		<p class="style0">                                    df_one_year.loc[:, 'Feb':'Dec']], \</p>
		<br/>
		<p class="style0">                                                    axis = 1),</p>
		<br/>
		<p class="style0">                                    df_one_year['TempAvgF']))</p>
		<br/>
		<p class="style0">The results should be as follows:</p>
		<br/>
		<p class="style0">model coefficients: [ 0.03719346 1.57445204 9.35397321 19.16903518 22.02065629 26.80023439</p>
		<br/>
		<p class="style0">30.17121033 30.82466482 25.6117698 15.71715435 1.542969 -4.06777548]</p>
		<br/>
		<p class="style0">model intercept: 48.34038858048261</p>
		<br/>
		<p class="style0">model r squared: 0.7834805472165678</p>
		<br/>
		<p class="style0">Note the signs on the coefficients—the first value associated with Day_of_Year, and then the values for January through December follow. The coefficients for January, February, March, November, and December are negative, while those for June through September are positive. This makes sense for the seasons in Texas.</p>
		<br/>
		<p class="style0">Now, make predictions using the single-year data, and visualize the results:</p>
		<br/>
		<p class="style0"># make predictions using the data</p>
		<br/>
		<p class="style0">y_pred = \</p>
		<br/>
		<p class="style0">linear_model.predict(pd.concat([df_one_year.Day_of_Year, \</p>
		<br/>
		<p class="style0">                                df_one_year.loc[:, 'Feb':'Dec']], \</p>
		<br/>
		<p class="style0">                                                axis = 1))</p>
		<br/>
		<p class="style0">x_pred = df_one_year.Day_of_Year</p>
		<br/>
		<p class="style0">fig = plt.figure(figsize=(10, 7))</p>
		<br/>
		<p class="style0">ax = fig.add_axes([1, 1, 1, 1]);</p>
		<br/>
		<p class="style0"># Raw data</p>
		<br/>
		<p class="style0">ax.scatter(df_one_year.Day_of_Year, df_one_year.TempAvgF, \</p>
		<br/>
		<p class="style0">           label = 'Raw Data', c = 'k')</p>
		<br/>
		<p class="style0"># Moving averages</p>
		<br/>
		<p class="style0">ax.plot(df_one_year.Day_of_Year, df_one_year['20_d_mov_avg'], \</p>
		<br/>
		<p class="style0">        c = 'r', linestyle = '--', \</p>
		<br/>
		<p class="style0">        label = f'{window} day moving average')</p>
		<br/>
		<p class="style0"># regression predictions</p>
		<br/>
		<p class="style0">ax.plot(x_pred, y_pred, c = "blue", linestyle = '-.', \</p>
		<br/>
		<p class="style0">        label = 'linear model w/dummy vars')</p>
		<br/>
		<p class="style0">ax.set_title('Air Temperature Measurements', fontsize = 16)</p>
		<br/>
		<p class="style0">ax.set_xlabel('Day', fontsize = 14)</p>
		<br/>
		<p class="style0">ax.set_ylabel('Temperature ($^\circ$F)', fontsize = 14)</p>
		<br/>
		<p class="style0">ax.set_xticks(range(df_one_year.Day_of_Year.min(), \</p>
		<br/>
		<p class="style0">                    df_one_year.Day_of_Year.max(), 30))</p>
		<br/>
		<p class="style0">ax.tick_params(labelsize = 12)</p>
		<br/>
		<p class="style0">ax.legend(fontsize = 12, loc = 'upper left')</p>
		<br/>
		<p class="style0">plt.show()</p>
		<br/>
		<p class="style0">The output should appear as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-KI6KH1EE.jpg" alt="Figure 3.79: Linear regression results with month dummy variables&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.79: Linear regression results with month dummy variables</p>
		<br/>
		<h4 class="style2">Note</h4>
		<br/>
		<p class="style2">To access the source code for this specific section, please refer to https://packt.live/3enegOg.</p>
		<br/>
		<p class="style2">You can also run this example online at https://packt.live/2V4VgMM. You must execute the entire Notebook in order to get the desired result.</p>
		<div style="page-break-before: always;"/>
	

		<br/>
		<h4 class="style0">Activity 3.04: Feature Engineering with Linear Regression</h4>
		<br/>
		<p class="style0">Load the required packages and classes:</p>
		<br/>
		<p class="style0">import pandas as pd</p>
		<br/>
		<p class="style0">import numpy as np</p>
		<br/>
		<p class="style0">import matplotlib.pyplot as plt</p>
		<br/>
		<p class="style0">from sklearn.linear_model import LinearRegression</p>
		<br/>
		<p class="style0">Load the data and carry out preprocessing through to the point where Day_of_Year is added:</p>
		<br/>
		<p class="style0"># load data</p>
		<br/>
		<p class="style0">df = pd.read_csv('../Datasets/austin_weather.csv')</p>
		<br/>
		<p class="style0">df = df.loc[:, ['Date', 'TempAvgF']]</p>
		<br/>
		<p class="style0"># add some useful columns</p>
		<br/>
		<p class="style0">df.loc[:, 'Year'] = df.loc[:, 'Date'].str.slice(0, 4).astype('int')</p>
		<br/>
		<p class="style0">df.loc[:, 'Month'] = df.loc[:, 'Date'].str.slice(5, 7).astype('int')</p>
		<br/>
		<p class="style0">df.loc[:, 'Day'] = df.loc[:, 'Date'].str.slice(8, 10).astype('int')</p>
		<br/>
		<p class="style0">"""</p>
		<br/>
		<p class="style0">set a 20 day window then use that to smooth</p>
		<br/>
		<p class="style0">temperature in a new column</p>
		<br/>
		<p class="style0">"""</p>
		<br/>
		<p class="style0">window = 20</p>
		<br/>
		<p class="style0">df['20_d_mov_avg'] = df.TempAvgF.rolling(window).mean()</p>
		<br/>
		<p class="style0">"""</p>
		<br/>
		<p class="style0">now let's slice exactly one year on the</p>
		<br/>
		<p class="style0">calendar start and end dates</p>
		<br/>
		<p class="style0">we see from the previous output that</p>
		<br/>
		<p class="style0">2014 is the first year with complete data,</p>
		<br/>
		<p class="style0">however it will still have NaN values for</p>
		<br/>
		<p class="style0">the moving average, so we'll use 2015</p>
		<br/>
		<p class="style0">"""</p>
		<br/>
		<p class="style0">df_one_year = df.loc[df.Year == 2015, :].reset_index()</p>
		<br/>
		<p class="style0">df_one_year['Day_of_Year'] = df_one_year.index + 1</p>
		<br/>
		<p class="style0">Now, for the feature engineering, we construct the sine and cosine of Day_of_Year with a period of 365 days:</p>
		<br/>
		<p class="style0"># add two columns for sine and cosine of the Day_of_Year</p>
		<br/>
		<p class="style0">df_one_year['sine_Day'] = np.sin(2 * np.pi \</p>
		<br/>
		<p class="style0">                          * df_one_year['Day_of_Year'] / 365)</p>
		<br/>
		<p class="style0">df_one_year['cosine_Day'] = np.cos(2 * np.pi \</p>
		<br/>
		<p class="style0">                          * df_one_year['Day_of_Year'] / 365)</p>
		<br/>
		<p class="style0">df_one_year</p>
		<br/>
		<p class="style0">The data should appear as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-N39ZI5CT.jpg" alt="Figure 3.80: Austin weather data with the new features, sine_Day and cosine_Day&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.80: Austin weather data with the new features, sine_Day and cosine_Day</p>
		<br/>
		<p class="style0">We can now fit the model using the LinearRegression class from scikit-learn, and print the coefficients and the r2 score:</p>
		<br/>
		<p class="style0"># fit model using the Day_of_Year and sin/cos</p>
		<br/>
		<p class="style0">linear_model = LinearRegression(fit_intercept = True)</p>
		<br/>
		<p class="style0">linear_model.fit(df_one_year[['Day_of_Year', 'sine_Day', \</p>
		<br/>
		<p class="style0">                              'cosine_Day']], \</p>
		<br/>
		<p class="style0">                 df_one_year['TempAvgF'])</p>
		<br/>
		<p class="style0">print('model coefficients: ', linear_model.coef_)</p>
		<br/>
		<p class="style0">print('model intercept: ', linear_model.intercept_)</p>
		<br/>
		<p class="style0">print('model r squared: ', \</p>
		<br/>
		<p class="style0">linear_model.score(df_one_year[['Day_of_Year', 'sine_Day', \</p>
		<br/>
		<p class="style0">                                'cosine_Day']], \</p>
		<br/>
		<p class="style0">                   df_one_year['TempAvgF']))</p>
		<br/>
		<p class="style0">The output should be as follows:</p>
		<br/>
		<p class="style0">model coefficients: [ 1.46396364e-02 -5.57332499e+00 -1.67824174e+01]</p>
		<br/>
		<p class="style0">model intercept: 67.43327530313064</p>
		<br/>
		<p class="style0">model r squared: 0.779745650129063</p>
		<br/>
		<p class="style0">Note that the r2 value is about the same as we achieved with the dummy variables. However, let's look at the predictions and see whether this model might be more or less suitable than before.</p>
		<br/>
		<p class="style0">Generate predictions using the augmented data:</p>
		<br/>
		<p class="style0"># make predictions using the data</p>
		<br/>
		<p class="style0">y_pred = \</p>
		<br/>
		<p class="style0">linear_model.predict(df_one_year[['Day_of_Year', 'sine_Day', \</p>
		<br/>
		<p class="style0">                                  'cosine_Day']])</p>
		<br/>
		<p class="style0">x_pred = df_one_year.Day_of_Year</p>
		<br/>
		<p class="style0">Now, visualize the results:</p>
		<br/>
		<p class="style0">fig = plt.figure(figsize=(10, 7))</p>
		<br/>
		<p class="style0">ax = fig.add_axes([1, 1, 1, 1])</p>
		<br/>
		<p class="style0"># Raw data</p>
		<br/>
		<p class="style0">ax.scatter(df_one_year.Day_of_Year, df_one_year.TempAvgF, \</p>
		<br/>
		<p class="style0">           label = 'Raw Data', c = 'k')</p>
		<br/>
		<p class="style0"># Moving averages</p>
		<br/>
		<p class="style0">ax.plot(df_one_year.Day_of_Year, df_one_year['20_d_mov_avg'], \</p>
		<br/>
		<p class="style0">        c = 'r', linestyle = '--', \</p>
		<br/>
		<p class="style0">        label = f'{window} day moving average')</p>
		<br/>
		<p class="style0"># regression predictions</p>
		<br/>
		<p class="style0">ax.plot(x_pred, y_pred, c = "blue", linestyle = '-.', \</p>
		<br/>
		<p class="style0">        label = 'linear model w/sin-cos fit')</p>
		<br/>
		<p class="style0">ax.set_title('Air Temperature Measurements', fontsize = 16)</p>
		<br/>
		<p class="style0">ax.set_xlabel('Day', fontsize = 14)</p>
		<br/>
		<p class="style0">ax.set_ylabel('Temperature ($^\circ$F)', fontsize = 14)</p>
		<br/>
		<p class="style0">ax.set_xticks(range(df_one_year.Day_of_Year.min(), \</p>
		<br/>
		<p class="style0">                    df_one_year.Day_of_Year.max(), 30))</p>
		<br/>
		<p class="style0">ax.tick_params(labelsize = 12)</p>
		<br/>
		<p class="style0">ax.legend(fontsize = 12, loc = 'upper left')</p>
		<br/>
		<p class="style0">The output will be as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-G4DBEE5E.jpg" alt="Figure 3.81: Austin temperature data with moving average overlay and periodic feature fit overlay&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.81: Austin temperature data with moving average overlay and periodic feature fit overlay</p>
		<br/>
		<h4 class="style2">Note</h4>
		<br/>
		<p class="style2">To access the source code for this specific section, please refer to https://packt.live/3dvkmet.</p>
		<br/>
		<p class="style2">You can also run this example online at https://packt.live/3epnOIJ. You must execute the entire Notebook in order to get the desired result.</p>
		<div style="page-break-before: always;"/>
	

		<br/>
		<h4 class="style0">Activity 3.05: Gradient Descent</h4>
		<br/>
		<p class="style0">Import the modules and classes:</p>
		<br/>
		<p class="style0">import pandas as pd</p>
		<br/>
		<p class="style0">import numpy as np</p>
		<br/>
		<p class="style0">import matplotlib.pyplot as plt</p>
		<br/>
		<p class="style0">from sklearn.metrics import r2_score</p>
		<br/>
		<p class="style0">from sklearn.linear_model import SGDRegressor</p>
		<br/>
		<p class="style0">Load the data (austin_weather.csv) and preprocess it up to the point of creating the Day_of_Year column and slicing one full year (2015):</p>
		<br/>
		<p class="style0"># load data and inspect</p>
		<br/>
		<p class="style0">df = pd.read_csv('../Datasets/austin_weather.csv')</p>
		<br/>
		<p class="style0">df = df.loc[:, ['Date', 'TempAvgF']]</p>
		<br/>
		<p class="style0"># add time-based columns</p>
		<br/>
		<p class="style0">df.loc[:, 'Year'] = df.loc[:, 'Date'].str.slice(0, 4).astype('int')</p>
		<br/>
		<p class="style0">df.loc[:, 'Month'] = df.loc[:, 'Date'].str.slice(5, 7).astype('int')</p>
		<br/>
		<p class="style0">df.loc[:, 'Day'] = df.loc[:, 'Date'].str.slice(8, 10).astype('int')</p>
		<br/>
		<p class="style0">"""</p>
		<br/>
		<p class="style0">set a 20 day window then use that to smooth</p>
		<br/>
		<p class="style0">temperature in a new column</p>
		<br/>
		<p class="style0">"""</p>
		<br/>
		<p class="style0">window = 20</p>
		<br/>
		<p class="style0">df['20_d_mov_avg'] = df.TempAvgF.rolling(window).mean()</p>
		<br/>
		<p class="style0">"""</p>
		<br/>
		<p class="style0">now let's slice exactly one year on the</p>
		<br/>
		<p class="style0">calendar start and end dates</p>
		<br/>
		<p class="style0">we see from the previous output that</p>
		<br/>
		<p class="style0">2014 is the first year with complete data,</p>
		<br/>
		<p class="style0">however it will still have NaN values for</p>
		<br/>
		<p class="style0">the moving average, so we'll use 2015</p>
		<br/>
		<p class="style0">"""</p>
		<br/>
		<p class="style0">df_one_year = df.loc[df.Year == 2015, :].reset_index()</p>
		<br/>
		<p class="style0">df_one_year['Day_of_Year'] = df_one_year.index + 1</p>
		<br/>
		<p class="style0">print(df_one_year.head())</p>
		<br/>
		<p class="style0">print(df_one_year.tail())</p>
		<br/>
		<p class="style0">The output will be as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-WYG31OSL.jpg" alt="Figure 3.82: Preprocessed data before scaling&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.82: Preprocessed data before scaling</p>
		<br/>
		<p class="style0">Scale the data for training:</p>
		<br/>
		<p class="style0"># scale the data</p>
		<br/>
		<p class="style0">X_min = df_one_year.Day_of_Year.min()</p>
		<br/>
		<p class="style0">X_range = df_one_year.Day_of_Year.max() \</p>
		<br/>
		<p class="style0">          - df_one_year.Day_of_Year.min()</p>
		<br/>
		<p class="style0">Y_min = df_one_year.TempAvgF.min()</p>
		<br/>
		<p class="style0">Y_range = df_one_year.TempAvgF.max() \</p>
		<br/>
		<p class="style0">          - df_one_year.TempAvgF.min()</p>
		<br/>
		<p class="style0">scale_X = (df_one_year.Day_of_Year - X_min) / X_range</p>
		<br/>
		<p class="style0">train_X = scale_X.ravel()</p>
		<br/>
		<p class="style0">train_Y = ((df_one_year.TempAvgF - Y_min) / Y_range).ravel()</p>
		<br/>
		<p class="style0">Set random.seed, instantiate the model object with SGDRegressor, and fit the model to the training data:</p>
		<br/>
		<p class="style0"># create the model object</p>
		<br/>
		<p class="style0">np.random.seed(42)</p>
		<br/>
		<p class="style0">model = SGDRegressor(loss = 'squared_loss', max_iter = 100, \</p>
		<br/>
		<p class="style0">                     learning_rate = 'constant', eta0 = 0.0005, \</p>
		<br/>
		<p class="style0">                     tol = 0.00009, penalty = 'none')</p>
		<br/>
		<p class="style0"># fit the model</p>
		<br/>
		<p class="style0">model.fit(train_X.reshape((-1, 1)), train_Y)</p>
		<br/>
		<p class="style0">The output should be as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-837LOO8W.jpg" alt="Figure 3.83: Model object using SGDRegressor&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.83: Model object using SGDRegressor</p>
		<br/>
		<p class="style0">Extract the model coefficients and rescale:</p>
		<br/>
		<p class="style0">Beta0 = (Y_min + Y_range * model.intercept_[0] \</p>
		<br/>
		<p class="style0">         - Y_range * model.coef_[0] * X_min / X_range)</p>
		<br/>
		<p class="style0">Beta1 = Y_range * model.coef_[0] / X_range</p>
		<br/>
		<p class="style0">print(Beta0)</p>
		<br/>
		<p class="style0">print(Beta1)</p>
		<br/>
		<p class="style0">The output should be similar to the following:</p>
		<br/>
		<p class="style0">61.45512325422412</p>
		<br/>
		<p class="style0">0.04533603293003107</p>
		<br/>
		<p class="style0">Generate predictions using the scaled data, and then get the r2 value:</p>
		<br/>
		<p class="style0"># generate predictions</p>
		<br/>
		<p class="style0">pred_X = df_one_year['Day_of_Year']</p>
		<br/>
		<p class="style0">pred_Y = model.predict(train_X.reshape((-1, 1)))</p>
		<br/>
		<p class="style0"># calculate the r squared value</p>
		<br/>
		<p class="style0">r2 = r2_score(train_Y, pred_Y)</p>
		<br/>
		<p class="style0">print('r squared = ', r2)</p>
		<br/>
		<p class="style0">The result should be similar to the following:</p>
		<br/>
		<p class="style0">r squared = 0.09462157379706759</p>
		<br/>
		<p class="style0">Scale the predictions back to real values and then visualize the results:</p>
		<br/>
		<p class="style0"># scale predictions back to real values</p>
		<br/>
		<p class="style0">pred_Y = (pred_Y * Y_range) + Y_min</p>
		<br/>
		<p class="style0">fig = plt.figure(figsize = (10, 7))</p>
		<br/>
		<p class="style0">ax = fig.add_axes([1, 1, 1, 1])</p>
		<br/>
		<p class="style0"># Raw data</p>
		<br/>
		<p class="style0">ax.scatter(df_one_year.Day_of_Year, df_one_year.TempAvgF, \</p>
		<br/>
		<p class="style0">           label = 'Raw Data', c = 'k')</p>
		<br/>
		<p class="style0"># Moving averages</p>
		<br/>
		<p class="style0">ax.plot(df_one_year.Day_of_Year, df_one_year['20_d_mov_avg'], \</p>
		<br/>
		<p class="style0">        c = 'r', linestyle = '--', \</p>
		<br/>
		<p class="style0">        label = f'{window} day moving average')</p>
		<br/>
		<p class="style0"># Regression predictions</p>
		<br/>
		<p class="style0">ax.plot(pred_X, pred_Y, c = "blue", linestyle = '-.', \</p>
		<br/>
		<p class="style0">        linewidth = 4, label = 'linear fit (from SGD)')</p>
		<br/>
		<p class="style0"># put the model on the plot</p>
		<br/>
		<p class="style0">ax.text(1, 85, 'Temp = ' + str(round(Beta0, 2)) + ' + ' \</p>
		<br/>
		<p class="style0">        + str(round(Beta1, 4)) + ' * Day', fontsize = 16)#</p>
		<br/>
		<p class="style0">ax.set_title('Air Temperature Measurements', fontsize = 16)</p>
		<br/>
		<p class="style0">ax.set_xlabel('Day', fontsize = 16)</p>
		<br/>
		<p class="style0">ax.set_ylabel('Temperature ($^\circ$F)', fontsize = 14)</p>
		<br/>
		<p class="style0">ax.set_xticks(range(df_one_year.Day_of_Year.min(), \</p>
		<br/>
		<p class="style0">                    df_one_year.Day_of_Year.max(), 30))</p>
		<br/>
		<p class="style0">ax.tick_params(labelsize = 12)</p>
		<br/>
		<p class="style0">ax.legend(fontsize = 12)</p>
		<br/>
		<p class="style0">plt.show()</p>
		<br/>
		<p class="style0">The output will be as follows:</p>
		<br style="line-height: 1,4"/>
		<div>
			<img src="../Images/image-9X6YLZSP.jpg" alt="Figure 3.84: Results of linear regression using SGDRegressor&#13;&#10;" height="100%"/>
		</div>
		<br/>
		<br/>
		<p class="style0" style="text-align: center">Figure 3.84: Results of linear regression using SGDRegressor</p>
		<br/>
		<h4 class="style2">Note</h4>
		<br/>
		<p class="style2">To access the source code for this specific section, please refer to https://packt.live/2AY1bMZ.</p>
		<br/>
		<p class="style2">You can also run this example online at https://packt.live/2NgCI86. You must execute the entire Notebook in order to get the desired result.</p>
		<div style="page-break-before: always;"/>
	</body></html>